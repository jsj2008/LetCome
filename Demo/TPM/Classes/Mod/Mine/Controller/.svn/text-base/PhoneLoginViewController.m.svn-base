//
//  PhoneLoginViewController.m
//  STO
//
//  Created by chenyi on 16/4/13.
//  Copyright © 2016年 JYZD. All rights reserved.
//

#import "PhoneLoginViewController.h"
#import "SetListEntity.h"
#import "SetListSection.h"
#import "SetPasswordViewController.h"
#import "SetPhoneNumViewController.h"

@interface PhoneLoginViewController (){
    SetListEntity *phoneEntity;
}

@end

@implementation PhoneLoginViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    self.title = @"手机号登录设置";
    // Do any additional setup after loading the view from its nib.
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void)viewWillAppear:(BOOL)animated{
    phoneEntity.descText = [[UserInfoManager shareUserInfoManager] getUserPhonenumber];
    [self.pAdaptor notifyChanged];
}

-(void)initQuickUI{
    
    self.pAdaptor = [QUFlatAdaptor adaptorWithTableView:self.myTab nibArray:@[@"SetListSection",@"AppFlatEmptySection"] delegate:self];
    
    QUEntity* empty=[QUEntity entityWithLine:QU_FLAT_COLOR_LINE];
    
    [self.pAdaptor.pSources addEntity:empty withSection:[SetEmptyListSection class]];
    
    phoneEntity = [SetListEntity entity];
    phoneEntity.sectionList = @"手机号";
    NSString* userPhoneNum = [[UserInfoManager shareUserInfoManager] getUserPhonenumber];
    phoneEntity.descText = userPhoneNum;
    phoneEntity.tag = 1;
    phoneEntity.selectionStyle = UITableViewCellSelectionStyleGray;
    phoneEntity.lineBottomColor = QU_FLAT_COLOR_LINE;
    phoneEntity.pIndentBottomLevel = 1;
    phoneEntity.selectedBgColor = QU_FLAT_COLOR_CELL_BG_SELECTED;
    [self.pAdaptor.pSources addEntity:phoneEntity withSection:[SetSimpleListSection class]];

    SetListEntity* entity2 = [SetListEntity entity];
    entity2.sectionList = @"修改密码";
    entity2.descText = @"";
    entity2.tag = 2;
    entity2.selectionStyle = UITableViewCellSelectionStyleGray;
    //    entity2.lineBottomColor = QU_FLAT_COLOR_LINE;
    entity2.selectedBgColor = QU_FLAT_COLOR_CELL_BG_SELECTED;
    [self.pAdaptor.pSources addEntity:entity2 withSection:[SetSimpleListSection class]];
    empty = [QUEntity entityWithLineTop:QU_FLAT_COLOR_LINE lineBottom:nil];
    [self.pAdaptor.pSources addEntity:empty withSection:[SetEmptyListSection class]];
    [self.pAdaptor setSectionFrame:CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 15) sectionClassName:@"AppFlatEmptySection"];

    [self.pAdaptor notifyChanged];
}

-(void)QUAdaptor:(QUAdaptor *)adaptor forSection:(QUSection *)section forEntity:(QUEntity *)entity{
    
    if ([section isKindOfClass:[SetSimpleListSection class]]) {
        SetListEntity* e = (SetListEntity*)entity;
        SetSimpleListSection* s = (SetSimpleListSection*)section;
        s.title.text = e.sectionList;
        s.lblContent.hidden = NO;
        s.lblContent.text = e.descText;
    }
}

-(void)QUAdaptor:(QUAdaptor *)adaptor selectedSection:(QUSection *)section entity:(QUEntity *)entity{
    
    if(entity.tag == 1)
    {

        SetPhoneNumViewController *controller = [[SetPhoneNumViewController alloc]initWithNibName:@"SetPhoneNumViewController" bundle:nil];
        [self.navigationController pushViewController:controller animated:YES];
        
    }
    if (entity.tag == 2) {
     
        SetPasswordViewController *controller = [[SetPasswordViewController alloc]initWithNibName:@"SetPasswordViewController" bundle:nil];
        [self.navigationController pushViewController:controller animated:YES];
    }
}

/*
#pragma mark - Navigation

// In a storyboard-based application, you will often want to do a little preparation before navigation
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    // Get the new view controller using [segue destinationViewController].
    // Pass the selected object to the new view controller.
}
*/

@end
