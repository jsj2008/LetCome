//
//  NoticeView.m
//  TPM
//
//  Created by tongshangren on 16/8/2.
//  Copyright © 2016年 JYZD. All rights reserved.
//

#import "NoticeView.h"

@implementation NoticeView

-(void)awakeFromNib{
    
    int winwidth=[UIScreen mainScreen].bounds.size.width;
    int winheight=[UIScreen mainScreen].bounds.size.height;
    
    self.frame=CGRectMake(0, 0, winwidth, winheight);
    
    self.agreementView.layer.masksToBounds = YES;
    self.agreementView.layer.cornerRadius=8.0;
    [self.btnClose addTarget: self action:@selector(closeFunc) forControlEvents:UIControlEventTouchUpInside];
}


-(void)closeFunc{
    [self removeFromSuperview];
}


- (CGSize)sizeWithAttributedString:(NSAttributedString *)string frameWidth:(float)width font:(UIFont *)font
{
    CGRect rect = [string boundingRectWithSize:CGSizeMake(width, 1000) options:NSStringDrawingTruncatesLastVisibleLine | NSStringDrawingUsesFontLeading  |NSStringDrawingUsesLineFragmentOrigin context:nil];
    //CGRect rect=CGRectMake(0, 0, 320, 300);
    return rect.size;
}


-(void)showContent:(NSString *)content{
    
    int winwidth=[UIScreen mainScreen].bounds.size.width;
    int winheight=[UIScreen mainScreen].bounds.size.height;
    //协议框
    NSAttributedString *agreetext = [[NSAttributedString alloc] initWithData:[content dataUsingEncoding:NSUnicodeStringEncoding] options:@{ NSDocumentTypeDocumentAttribute: NSHTMLTextDocumentType } documentAttributes:nil error:nil];
    CGSize size=[self sizeWithAttributedString:agreetext frameWidth:(winwidth-100) font:[UIFont systemFontOfSize:12.f]];
    
    
    
    int agreementViewHeight=winheight-80;
    if (size.height+60<winheight-80) {
        agreementViewHeight=size.height+60;
    }
    
    self.agreementView.frame=CGRectMake(25, (winheight-agreementViewHeight)/2, winwidth-50, agreementViewHeight);

    
    //关闭按钮
    self.btnClose.frame=CGRectMake(winwidth-41, (winheight-agreementViewHeight)/2-16, 32, 32);
    

    
    //textView
    self.textView.frame =CGRectMake(20, 20, winwidth-85,agreementViewHeight-40);
    NSAttributedString *attrStr = [[NSAttributedString alloc] initWithData:[content dataUsingEncoding:NSUnicodeStringEncoding] options:@{ NSDocumentTypeDocumentAttribute: NSHTMLTextDocumentType } documentAttributes:nil error:nil];
    self.textView.attributedText=attrStr;
    
}


@end
